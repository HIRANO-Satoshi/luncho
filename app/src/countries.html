<template>
  <style>
   .aut-sortable:after {
     content: "↕︎";
   }
   .aut-asc:after{
     content: "↓";
   }
   .aut-desc:after{
     content: "↑";
   }
   .large-input input {
     font-size: 160% !important;
   }
   .filters .col {
     padding-left: 0;
   }
  </style>

  <div class="container">
    <p><a href="/#/about"> Explanation</a></p>

    <!-- <h5>
         Convert Luncho for all countries
         </h5> -->
    <div class="valign-wrapper">
      <md-input label="Luncho " value.bind="lunchoValue"
                input.delegate="lunchosForCountries()"
                class="width-10em large-input"></md-input>
      <!-- <button md-button click.delegate="lunchosForCountries()">Calc</button> -->
    </div>
    <div class="vspace"></div>

    <div class="row filters">
      <div class="col s12 m5 l4">
        <!-- XXX fails selection sometimes on mobile -->
        <select md-select value.two-way="filters[1].value" class="country-select">
          <option model.bind="null">All continents</option>
          <option repeat.for="continent_code of app.continents | keys" model.bind="continent_code">
            ${app.continents[continent_code]}</option>
        </select>
      </div>
      <div class="col s12 m5 l4">
        <md-input type="text" value.bind="filters[0].value"
                  placeholder="Country name, Currency" class="form-control"/>
      </div>
    </div>

    <table id="all-table"  class="table table-striped"
           aurelia-table="data.bind: lunchoDatas; display-data.bind: $displayData; filters.bind: filters">
      <thead>
        <tr>
          <th aut-sort="key: country_name">Country</th>
          <th if.bind="showCode"></th>
          <th aut-sort="key: continent_code">Continent</th>
          <th>Local</th>
          <th aut-sort="key: currency_name">Currency</th>
          <th if.bind="showCode"></th>
          <th aut-sort="key: dollar_value; default: desc">US Dollar</th>
        </tr>
      </thead>
      <tbody>
        <!-- <tr repeat.for="country_code of luncho.lunchoDataCache | keys" with.bind="luncho.lunchoDataCache[country_code]"> -->
        <tr repeat.for="country_code of $displayData | keys" with.bind="$displayData[country_code]">
          <td>${country_name}</td>
          <td if.bind="showCode">${country_code}</td>
          <td>${app.continents[continent_code]}</td>

          <td if.bind="local_currency_value > 0 && app.countryData.currencies[currency_code].decimals == 0">${local_currency_value | numberFormat: '0'}</td>
          <td if.bind="local_currency_value > 0 && app.countryData.currencies[currency_code].decimals == 1">${local_currency_value | numberFormat: '0.0'}</td>
          <td if.bind="local_currency_value > 0 && app.countryData.currencies[currency_code].decimals == 2">${local_currency_value | numberFormat: '0.00'}</td>
          <td if.bind="local_currency_value > 0 && app.countryData.currencies[currency_code].decimals == 3">${local_currency_value | numberFormat: '0.000'}</td>
          <td if.bind="!(local_currency_value > 0)">?</td>

          <td>${currency_name}</td>

          <td if.bind="showCode">${currency_code}</td>
          <td if.bind="dollar_value"> $${dollar_value | numberFormat: '0.00'}</td>
          <td else></td>
        </tr>
      </tbody>
    </table>

    <div style="height: 3em;"></div>
    <md-checkbox checked.bind="showCode">Show code</md-checkbox>
  </div>

</template>
